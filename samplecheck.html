<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Checkout Page</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css" />

    <!--owl slider stylesheet -->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"
    />
    <!-- nice select  -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css"
      integrity="sha512-CruCP+TD3yXzlvvijET8wV5WxxEh5H8P4cmz0RFbKK6FlZ2sYl3AEsKlLPHbniXKSrDdFewhbmBK5skbdsASbQ=="
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <!-- font awesome style -->
    <link href="/css/font-awesome.min.css" rel="stylesheet" />

    <!-- Custom styles for this template -->
    <link href="/css/style.css" rel="stylesheet" />
    <!-- responsive style -->
    <link href="/css/responsive.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/ar.css">
    <title>Cart</title>
    <style>
      .icon-hover-primary:hover {
        border-color: #3b71ca !important;
        background-color: white !important;
      }

      .icon-hover-primary:hover i {
        color: #3b71ca !important;
      }
      .icon-hover-danger:hover {
        border-color: #dc4c64 !important;
        background-color: white !important;
      }

      .icon-hover-danger:hover i {
        color: #dc4c64 !important;
      }
    </style>
  </head>
  <body>
    <header>
      <!-- Jumbotron -->
      <div class="p-3 text-center bg-white border-bottom">
        <div class="container">
          <div class="row gy-3">
            <!-- Left elements -->
            <div class="col-lg-2 col-sm-4 col-4">
              <a class="navbar-brand" href="#">
                <span style="color: black"> Footwear </span>
              </a>
            </div>
            <!-- Left elements -->

            <!-- Center elements -->
            <div class="order-lg-last col-lg-5 col-sm-8 col-8">
              <div class="d-flex float-end">
                <!-- <a href="" class="me-1 border rounded py-1 px-3 nav-link d-flex align-items-center" target="_blank">
                    <i class="fas fa-user-alt m-1 me-md-2"></i>
                    <p class="d-none d-md-block mb-0">Sign in</p>
                  </a> -->
                <a
                  href="#"
                  class="me-1 border rounded py-1 px-3 nav-link d-flex align-items-center"
                  target="_blank"
                >
                  <i class="fas fa-heart m-1 me-md-2"></i>
                  <p class="d-none d-md-block mb-0">Wishlist</p>
                </a>
                <a
                  href="/getCartPage"
                  class="border rounded py-1 px-3 nav-link d-flex align-items-center"
                  target="_blank"
                >
                  <i class="fas fa-shopping-cart m-1 me-md-2"></i>
                  <p class="d-none d-md-block mb-0">My cart</p>
                </a>
              </div>
            </div>
            <!-- Center elements -->

            <!-- Right elements -->
            <div class="col-lg-5 col-md-12 col-12">
              <div class="input-group float-center">
                <div class="form-outline">
                  <!-- <input type="search" id="form1" class="form-control" />
                    <label class="form-label" for="form1">Search</label> -->
                </div>
                <!-- <button type="button" class="btn btn-primary shadow-0">
                    <i class="fas fa-search"></i>
                  </button> -->
              </div>
            </div>
            <!-- Right elements -->
          </div>
        </div>
      </div>
      <!-- Jumbotron -->

      <!-- Heading -->
      <div class="bg-light">
        <div class="container py-4">
          <!-- Breadcrumb -->
          <nav class="d-flex">
            <h6 class="mb-0">
              <a href="/userHomePage" class="text-blue-50">Home</a>
              <span class="text-black-50 mx-2"> > </span>
              <a href="/getCartPage" class="text-black"><u>Shopping cart</u></a>
              <span class="text-black-50 mx-2"> > </span>
              <a class="text-black mx-2"><u>Checkout</u></a>
            </h6>
          </nav>
          <!-- Breadcrumb -->
        </div>
      </div>
      <!-- Heading -->
    </header>
    <div class="container mt-5">
      <div class="row">
        <!-- Cart Items Section -->
        <div class="col-md-6">
          <h3 class="mb-4">Checkout Page</h3>
          <% if (cart && cart.items.length > 0) { %> <% let total = 0; %> <%
          cart.items.forEach(item => { %>
          <div
            class="cart-item d-flex justify-content-between align-items-center border-bottom py-3"
          >
            <div class="item-info d-flex align-items-center">
              <img
                src="<%= item.product.images[0] %>"
                class="border rounded me-3"
                style="width: 96px; height: 96px"
              />
              <div class="ms-3">
                <h5><%= item.productName %></h5>
                <p class="text-muted">Quantity: <%= item.quantity %></p>
              </div>
            </div>
            <span class="fw-bold">$<%= item.price %></span>
          </div>
          <% total += item.price; %> <% }) %>
          <!-- Total -->
          <div class="d-flex justify-content-between align-items-center mt-3">
            <h5>Total</h5>
            <span class="fw-bold">$<%= total %></span>
          </div>
          <% } else { %>
          <p>Your Checkout Page is empty.</p>
          <% } %>
        </div>
        <!-- Address and Payment Section -->
        <div class="col-md-6">
          <div>
              <div class="card mb-3 border shadow-0">
                <div class="card-body">
                  <form id="applyCouponForm">
                    <div class="form-group">
                      <label class="form-label">Have coupon?</label>
                      <div class="input-group">
                        <input type="text" id="couponCode" class="form-control border" name="couponCode" placeholder="Coupon code" />
                        <button class="btn btn-light border">Apply</button>
                      </div>
                    </div>
                  </form>
                  <div id="couponResult"></div>
                </div>
              </div>
              <div class="card shadow-0 border">
                <div class="card-body">
                  <div class="d-flex justify-content-between">
                    <p class="mb-2">Total:</p>
                    <p id="cart-total" class="mb-2">₹<%= cart ? cart.total_price.toFixed(2) : '0.00' %></p>
                  </div>
                  <div class="d-flex justify-content-between">
                    <p class="mb-2">Discount:</p>
                    <p class="mb-2 text-success" id="couponDiscount">00</p>
                  </div>
                  <hr />
                  <div class="d-flex justify-content-between">
                    <p class="mb-2">Net Amount:</p>
                    <p class="mb-2 fw-bold" id="couponTotal">₹<%= cart ? cart.total_price.toFixed(2) : '0.00' %></p>
                  </div>
              </div>
            </div>
          <h3 class="mb-4">Delivery Information</h3>
          <!-- Existing Addresses -->
          <div id="addressList">
            <label for="addressSelect" class="form-label">Select an Address</label>
            <div class="form-group">
              <select class="form-control" id="exampleFormControlSelect1">
                <option value="">Select address</option>
                <% address.forEach(function(Address) { %>
                <option value="<%= Address._id %>">
                  <%= Address.streetAddress %>, <%= Address.fullName %>
                </option>
                <% }); %>
              </select>
            </div>
          </div>
          <!-- Add New Address Button -->
           <div class="col-md-6">
             <button class="btn btn-outline-primary mt-5" id="addNewAddressBtn">
               + Add New Address
             </button>
           </div>
          <!-- New Address Form (Initially Hidden) -->
          <div id="newAddressForm" style="display: none">
            <form action="#" method="post" enctype="multipart/form-data">
              <div class="mb-3">
                <label for="name" class="form-label">Full Name</label>
                <input type="text"class="form-control"id="name"placeholder="Enter your full name"/>
              </div>
              <div class="mb-3">
                <label for="address" class="form-label">Address</label>
                <textarea  class="form-control" id="address" rows="3" placeholder="Enter your address"></textarea>
              </div>
              <div class="mb-3">
                <label for="phoneNumber" class="form-label">Phone</label>
                <input  class="form-control" id="phoneNumber"placeholder="Enter your Phone"></input>
              </div>
              <div class="mb-3">
                <label for="state" class="form-label">State</label>
                <input  class="form-control" id="state"placeholder="Enter your state"></input>
              </div>
              <div class="mb-3">
                <label for="country" class="form-label">Country</label>
                <input  class="form-control" id="country"placeholder="Enter your country"></input>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="city" class="form-label">City</label>
                    <input type="text"class="form-control"id="city"placeholder="Enter your city"/>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="zipcode" class="form-label">Zip Code</label>
                    <input type="text"class="form-control" id="zipcode" placeholder="Enter your zip code" />
                  </div>
                </div>
              </div>
              <button type="button" class="btn btn-success mt-3 w-100 mt-5" onclick="addAddress()"> Save Address</button>
            </form>
          </div>

          <!-- Payment Method Section -->
          <h3 class="mt-5 mb-3">Payment Method</h3>
          <div class="form-check">
          <input class="form-check-input" type="radio" name="paymentMethod" id="cod" checked />
          <label class="form-check-label" for="cod">Cash on Delivery</label>
          </div>
          <div class="form-check">
          <input class="form-check-input" type="radio" name="paymentMethod" id="card" />
          <label class="form-check-label" for="card">Credit/Debit Card</label>
          </div>
          <button type="button" onclick="placeOrder()" class="btn btn-primary mt-3 w-100">
            Place Order
          </button>
        </div>
      </div>
    </div>
    <!-- footer section -->
    
    <!-- footer section -->
    <script src="js/jquery-3.4.1.min.js"></script>
    <!-- popper js -->
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <!-- bootstrap js -->
    <script src="js/bootstrap.js"></script>
    <!-- owl slider -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <!-- isotope js -->
    <script src="https://unpkg.com/isotope-layout@3.0.4/dist/isotope.pkgd.min.js"></script>
    <!-- nice select -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js"></script>
    <!-- custom js -->
    <script src="js/custom.js"></script>
    <!-- Google Map -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap"></script>
    <!-- End Google Map -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <script>
      // Toggle new address form display
      document
        .getElementById("addNewAddressBtn")
        .addEventListener("click", function () {
          const form = document.getElementById("newAddressForm");
          form.style.display = form.style.display === "none" ? "block" : "none";
        });

      // Toggle card details display based on payment method selected
      document.getElementById("cod").addEventListener("click", function () {
        document.getElementById("card-details").style.display = "none";
      });

      document.getElementById("card").addEventListener("click", function () {
        document.getElementById("card-details").style.display = "block";
      });
    </script>
    <script>
      async function addAddress(){
        const fullName =document.getElementById('name').value.trim();
        const streetAddress =document.getElementById('address').value.trim();
        const phone =document.getElementById('phoneNumber').value.trim();
        const city =document.getElementById('city').value.trim();
        const zipCode =document.getElementById('zipcode').value.trim();
        const state =document.getElementById('state').value.trim();
        const country =document.getElementById('country').value.trim();

        const phonePattern = /^(\+?\d{1,3}[-.\s]?)?\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$/;

        if(!fullName || !streetAddress || !phone || !city || !zipCode || !state || !country){
          Swal.fire({
              title: "Error",
              text: "All fields must be filled",
              icon: "error",
              confirmButtonText: "Okay"
          });
          return;
        }
        if(streetAddress.trim().split(/\s+/).length > 30) {
        Swal.fire({
        title: 'Error',
        text: "Only 30 words allowed",
        icon: "error",
        confirmButtonText: "Okay"
    });
    return;
       }
    if (!phonePattern.test(phone)) {
    Swal.fire({
        title: 'Error',
        text: "Invalid phone number format",
        icon: "error",
        confirmButtonText: "Okay"
    });
    return;
}
if (zipCode.length < 6 || /\s/.test(zipCode)) {
      Swal.fire({
        title:'Error',
        text:"Zipcode must be at least 6 characters and contain no spaces",
        icon:"error"
      });
      return;
    }
    try {
      const response=await fetch('/addAddress',{
      method:'POST',
      headers:{
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({fullName,streetAddress,phone,city,zipCode,state,country })
    });
    if (response.ok) {
            Swal.fire({
                title: 'Address Added!',
                text: 'The new address was added successfully.',
                icon: 'success',
                timer: 2000,
                showConfirmButton: false
            }).then(() => {
                location.reload();
            });
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Failed!',
                text: 'Failed to add the address. Please try again.',
            });
        }
    } catch (error) {
        console.error('Error while adding address', error);
        Swal.fire({
            icon: 'error',
            title: 'Error!',
            text: 'An unexpected error occurred while adding the address.',
        });
    }
  }
    </script>

    <script>
  async function placeOrder() {
    const couponCode = document.getElementById('couponCode').value.trim();
    const addressId = document.getElementById('exampleFormControlSelect1').value.trim();
    const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').id.trim();

    if (!addressId || !paymentMethod) {
        Swal.fire({
            title: 'Error',
            text: 'Please select an address and payment method.',
            icon: "error"
        });
        return;
    }

    if (paymentMethod === 'cod') { 
        // Handle Cash on Delivery order
        try {
            const response = await fetch('/placeOrder', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ addressId, paymentMethod, couponCode })
            });

            if (response.ok) {
              console.log('res')
                Swal.fire({
                    title: 'Order Placed!',
                    text: 'Your order was placed successfully.',
                    icon: 'success',
                    timer: 2000,
                    showConfirmButton: false
                }).then(() => {
                  console.log('order')
                    window.location.href = '/orderHistory';
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Failed!',
                    text: 'Failed to place the order. Please try again.',
                });
            }
        } catch (error) {
            console.error('Error while placing order', error);
            Swal.fire({
                icon: 'error',
                title: 'Error!',
                text: 'An unexpected error occurred while placing the order.',
            });
        }
    } else if (paymentMethod === 'card') {
        // Handle Razorpay payment
        try {
            const response = await fetch('/razor-Pay-OrderCreate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ addressId, paymentMethod, couponCode })
            });

            if (response.ok) {
                const result = await response.json();
                console.log(result);
                
                if (result.success) {
                    const options = {
                        key: 'rzp_test_yn3COcw99NFgtQ', // Replace with your Razorpay key
                        amount: result.payableAmount,
                        currency: 'INR',
                        name: 'Arabian food court',
                        description: "Payment for order",
                        order_id: result.razorpayOrder.id,
                        handler: async function (response) {
                            const response2 = await fetch('/razor-Pay-Payment', {
                                method: "POST",
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                
                                
                                body: JSON.stringify({
                                    addressId, paymentMethod, couponCode,
                                    payment_id: response.razorpay_payment_id,  // Check this property
                                    order_id: response.razorpay_order_id,      // Check this property
                                    signature: response.razorpay_signature
                                })
                            });
                            const verifyData = await response2.json();
                            if (response2.ok && verifyData.success) {
                              console.log(ifcondition)
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Order Placed',
                                    text: 'Your order has been placed successfully.',
                                    confirmButtonText: 'OK',
                                    timer: 2000
                                }).then(() => {
                                  console.log('order')
                                    window.location.href = '/orderHistory';
                                });
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: "Payment Failed",
                                    text: verifyData.error || 'Payment verification failed. Please try again.',
                                    confirmButtonText: 'OK'
                                });
                            }
                        },
                        prefill: {
                            name: 'User Name', // Replace with actual user data
                            email: 'useremail@email.com',
                            contact: '112233665544' // Replace with actual contact info
                        },
                        theme: {
                            color: "#000000"
                        }
                    };
                    console.log(options);
                    
                    const razorpay = new Razorpay(options);

                    razorpay.on('payment.failed', async function (response) {
                        console.log('Payment failed:', response.error);
                        Swal.fire({
                            icon: 'error',
                            title: 'Payment Failed',
                            text: 'The payment was not completed. Please try again.',
                            confirmButtonText: 'OK'
                        });
                    });

                    razorpay.open();

                } else {
                    Swal.fire({
                        icon: 'error',
                        title: "Payment Failed",
                        text: 'Payment verification failed. Please try again.',
                        confirmButtonText: 'OK'
                    });
                }

            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Failed to Order',
                    text: 'Unable to place order. Please try again later.',
                    confirmButtonText: 'OK'
                });
            }
        } catch (error) {
            console.error('Error while processing payment', error);
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'An unexpected error occurred while processing the payment.',
                confirmButtonText: 'OK'
            });
        }
    }
  }
</script>
>

<script>
  //Apply Coupon --------Section
  document.getElementById('applyCouponForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const couponCode = document.getElementById('couponCode').value;
    let originalTotal = parseFloat(document.getElementById('couponTotal').getAttribute('data-original-total'));

    // If original total isn't stored, store it the first time the coupon is applied
    if (!originalTotal) {
        originalTotal = parseFloat(document.getElementById('couponTotal').textContent.replace('₹', ''));
        document.getElementById('couponTotal').setAttribute('data-original-total', originalTotal);
    }

    fetch('/apply-coupon', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ couponCode }),
    })
    .then(response => response.json())
    .then(data => {
        const resultDiv = document.getElementById('couponResult');
        const resultDiv2 = document.getElementById('couponDiscount');
        const resultDiv3 = document.getElementById('couponTotal');
        
        if (data.success) {
            resultDiv.innerHTML = `
                <p class="text-success">Coupon applied successfully!</p>
                <p id="RemoveCouponCode">Your Code: ${data.couponCode}</p>
                <p>Discount Amount: ₹${data.discountAmount}</p>
                <button onclick="removeCoupon()">Remove Coupon</button>
            `;
            resultDiv2.innerHTML = `<p>₹${data.discountAmount}.00</p>`;
            resultDiv3.innerHTML = `<p>₹${data.finalAmount}.00</p>`;
        } else {
            resultDiv.innerHTML = `<p class="text-danger">${data.message}</p>`;
        }
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('couponResult').innerHTML = '<p>An error occurred while applying the coupon</p>';
    });
});

function removeCoupon() {
    const couponText = document.getElementById('RemoveCouponCode').textContent;
    const couponCode = couponText.replace('Your Code: ', '').trim();

    fetch('/remove-coupon', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ couponCode })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const resultDiv = document.getElementById('couponResult');
            const resultDiv2 = document.getElementById('couponDiscount');
            const resultDiv3 = document.getElementById('couponTotal');

            resultDiv.innerHTML = '<p class="text-success">Coupon removed successfully</p>';
            resultDiv2.innerHTML = '<p>₹0.00</p>';

            // Restore the original total amount
            const originalTotal = parseFloat(document.getElementById('couponTotal').getAttribute('data-original-total'));
            resultDiv3.innerHTML = `<p>₹${originalTotal}.00</p>`;

            // Clear the original total data attribute
            document.getElementById('couponTotal').removeAttribute('data-original-total');
        } else {
            document.getElementById('couponResult').innerHTML = `<p>${data.message}</p>`;
        }
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('couponResult').innerHTML = '<p>An error occurred while removing the coupon</p>';
    });
}

  </script>

  </body>
</html>

<!----------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" type="text/css" href="/css/bootstrap.css" />


  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css" integrity="sha512-CruCP+TD3yXzlvvijET8wV5WxxEh5H8P4cmz0RFbKK6FlZ2sYl3AEsKlLPHbniXKSrDdFewhbmBK5skbdsASbQ==" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

  <link href="/css/font-awesome.min.css" rel="stylesheet" />


  <link href="/css/style.css" rel="stylesheet" />

  <link href="/css/responsive.css" rel="stylesheet" />
  
    <title>Cart</title>
<style>
    .icon-hover-primary:hover {
  border-color: #3b71ca !important;
  background-color: white !important;
}

.icon-hover-primary:hover i {
  color: #3b71ca !important;
}
.icon-hover-danger:hover {
  border-color: #dc4c64 !important;
  background-color: white !important;
}

.icon-hover-danger:hover i {
  color: #dc4c64 !important;
}
</style>

</head>
<body>
    <header>
        <!-- Jumbotron -->
        <div class="p-3 text-center bg-white border-bottom">
          <div class="container">
            <div class="row gy-3">
              <!-- Left elements -->
              <div class="col-lg-2 col-sm-4 col-4">
                <a class="navbar-brand" href="#">
                    <span style="color: black">
                      Footwear
                    </span>
                  </a>
              </div>
              <!-- Left elements -->
      
              <!-- Center elements -->
              <div class="order-lg-last col-lg-5 col-sm-8 col-8">
                <div class="d-flex float-end">
                  <!-- <a href="" class="me-1 border rounded py-1 px-3 nav-link d-flex align-items-center" target="_blank">
                    <i class="fas fa-user-alt m-1 me-md-2"></i>
                    <p class="d-none d-md-block mb-0">Sign in</p>
                  </a> -->
                  <a href="#" class="me-1 border rounded py-1 px-3 nav-link d-flex align-items-center" target="_blank">
                    <i class="fas fa-heart m-1 me-md-2"></i>
                    <p class="d-none d-md-block mb-0">Wishlist</p>
                  </a>
                  <a href="/getCartPage" class="border rounded py-1 px-3 nav-link d-flex align-items-center" target="_blank">
                    <i class="fas fa-shopping-cart m-1 me-md-2"></i>
                    <p class="d-none d-md-block mb-0">My cart</p>
                  </a>
                </div>
              </div>
              <!-- Center elements -->
      
              <!-- Right elements -->
              <div class="col-lg-5 col-md-12 col-12">
                <div class="input-group float-center">
                  <div class="form-outline">
                    <!-- <input type="search" id="form1" class="form-control" />
                    <label class="form-label" for="form1">Search</label> -->
                  </div>
                  <!-- <button type="button" class="btn btn-primary shadow-0">
                    <i class="fas fa-search"></i>
                  </button> -->
                </div>
              </div>
              <!-- Right elements -->
            </div>
          </div>
        </div>
        <!-- Jumbotron -->
      
        <!-- Heading -->
        <div class="bg-light">
          <div class="container py-4">
            <!-- Breadcrumb -->
            <nav class="d-flex">
              <h6 class="mb-0">
                <a href="/userHomePage" class="text-blue-50">Home</a>
                <span class="text-black-50 mx-2"> > </span>
                <a href="" class="text-black"><u>Shopping cart</u></a>
              </h6>
            </nav>
            <!-- Breadcrumb -->
          </div>
        </div>
        <!-- Heading -->
      </header>
      
      <!-- cart + summary -->
      <section class="bg-light my-5">
        <div class="container">
          <div class="row">
            <!-- cart -->
            <div class="col-lg-9">
              <div class="card border shadow-0">
                <div class="m-4">
                  <h4 class="card-title mb-4">Your shopping cart</h4>
                  <% if (cart && cart.items.length > 0) { %>
                    <% cart.items.forEach(item => { %>
                      <div class="cart-item" data-item-id="<%= item._id %>">
                        <div class="row gy-3 mb-4">
                          <div class="col-lg-5">
                            <div class="me-lg-5">
                              <div class="d-flex">
                                <img src="<%= item.product.images[0] %>" class="border rounded me-3" style="width: 96px; height: 96px;" />
                                <div class="">
                                  <a href="#" class="nav-link"><%= item.product.productname %></a>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-2 col-sm-6 col-6 d-flex flex-row flex-lg-column flex-xl-row text-nowrap">
                            <div class="quantity-control">
                              <button class="quantity-btn minus">-</button>
                              <input type="number" class="quantity-input" value="<%= item.quantity %>" min="1" max="5" readonly>
                              <button class="quantity-btn plus">+</button>
                            </div>
                            <div class="">
                              <text class="h6">₹<span class="price-value"><%= item.price.toFixed(2) %></span></text> <br />
                              <!-- Display unit price -->
                              <small class="text-muted text-nowrap"> ₹<%= item.price / item.quantity %> / per item </small>
                              
                            </div>
                          </div>
                          <div class="col-lg col-sm-6 d-flex justify-content-sm-center justify-content-md-start justify-content-lg-center justify-content-xl-end mb-2">
                            <div class="float-md-end">
                              <!-- Favorite button -->
                              <a href="#!" class="btn btn-light border px-2 icon-hover-primary"><i class="fas fa-heart fa-lg px-1 text-secondary"></i></a>
                              <!-- Remove from cart button -->
                              <button class="remove-item-btn btn btn-outline-danger" data-item-id="<%= item._id %>">Remove</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    <% }) %>
                    <!-- <p class="total-price">Total: ₹<span id="cart-total"><%= cart.total_price.toFixed(2) %></span></p> -->
                  <% } else { %>
                    <p>Your cart is empty.</p>
                  <% } %>
                </div>
                <div class="border-top pt-4 mx-4 mb-4">
                  <p><i class="fas fa-truck text-muted fa-lg"></i> Free Delivery within 1-2 Hours</p>
                  <p class="text-muted">
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut
                    aliquip
                  </p>
                </div>
              </div>
            </div>
            <!-- cart -->
            <!-- summary -->
            <div class="col-lg-3">
              <div class="card mb-3 border shadow-0">
                <div class="card-body">
                  <form>
                    <div class="form-group">
                      <label class="form-label">Have coupon?</label>
                      <div class="input-group">
                        <input type="text" class="form-control border" name="" placeholder="Coupon code" />
                        <button class="btn btn-light border">Apply</button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
              <div class="card shadow-0 border">
                <div class="card-body">
                  <div class="d-flex justify-content-between">
                    <p class="mb-2">Total:</p>
                    <p id="cart-total" class="mb-2">₹<%= cart ? cart.total_price.toFixed(2) : '0.00' %></p>
                  </div>
                  <div class="d-flex justify-content-between">
                    <p class="mb-2">Discount:</p>
                    <p class="mb-2 text-success">00</p>
                  </div>
                  <!-- <div class="d-flex justify-content-between">
                    <p class="mb-2">TAX:</p>
                    <p class="mb-2">$14.00</p>
                  </div> -->
                  <hr />
                  <div class="d-flex justify-content-between">
                    <p class="mb-2">Net Amount:</p>
                    <p class="mb-2 fw-bold">₹<%= cart ? cart.total_price.toFixed(2) : '0.00' %></p>
                  </div>
      
                  <div class="mt-3">
                    <a href="/checkOutPage" class="btn btn-success w-100 shadow-0 mb-2"> Make Purchase </a>
                    <a href="/userHomePage" class="btn btn-light w-100 border mt-2"> Back to shop </a>
                  </div>
                </div>
              </div>
            </div>
            <!-- summary -->
          </div>
        </div>
      </section>
      <!-- footer section -->
      <footer id="colorlib-footer" role="contentinfo">
        <div class="container">
          <div class="row row-pb-md">
            <div class="col footer-col colorlib-widget">
              <h4>About Footwear</h4>
              <p>Even the all-powerful Pointing has no control about the blind texts it is an almost
                unorthographic life</p>
              <p>
              <ul class="colorlib-social-icons">
                <li><a href="#"><i class="icon-twitter"></i></a></li>
                <li><a href="#"><i class="icon-facebook"></i></a></li>
                <li><a href="#"><i class="icon-linkedin"></i></a></li>
                <li><a href="#"><i class="icon-dribbble"></i></a></li>
              </ul>
              </p>
            </div>
            <div class="col footer-col colorlib-widget">
              <h4>Customer Care</h4>
              <p>
              <ul class="colorlib-footer-links">
                <li><a href="#">Contact</a></li>
                <li><a href="#">Returns/Exchange</a></li>
                <li><a href="#">Gift Voucher</a></li>
                <li><a href="#">Wishlist</a></li>
                <li><a href="#">Special</a></li>
                <li><a href="#">Customer Services</a></li>
                <li><a href="#">Site maps</a></li>
              </ul>
              </p>
            </div>
            <div class="col footer-col colorlib-widget">
              <h4>Information</h4>
              <p>
              <ul class="colorlib-footer-links">
                <li><a href="#">About us</a></li>
                <li><a href="#">Delivery Information</a></li>
                <li><a href="#">Privacy Policy</a></li>
                <li><a href="#">Support</a></li>
                <li><a href="#">Order Tracking</a></li>
              </ul>
              </p>
            </div>
  
            <div class="col footer-col">
              <h4>News</h4>
              <ul class="colorlib-footer-links">
                <li><a href="blog.html">Blog</a></li>
                <li><a href="#">Press</a></li>
                <li><a href="#">Exhibitions</a></li>
              </ul>
            </div>
  
            <div class="col footer-col">
              <h4>Contact Information</h4>
              <ul class="colorlib-footer-links">
                <li>291 South 21th Street, <br> Suite 721 New York NY 10016</li>
                <li><a href="tel://1234567920">+ 1235 2355 98</a></li>
                <li><a href="mailto:info@yoursite.com">info@yoursite.com</a></li>
                <li><a href="#">yoursite.com</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="copy">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p>
                <span><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                  Copyright &copy;
                  <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                  template is made with <i class="icon-heart" aria-hidden="true"></i> by <a
                    href="https://colorlib.com" target="_blank">Colorlib</a>
                  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </span>
                <span class="block">Demo Images: <a href="http://unsplash.co/" target="_blank">Unsplash</a>
                  , <a href="http://pexels.com/" target="_blank">Pexels.com</a></span>
              </p>
            </div>
          </div>
        </div>
      </footer>
  <!-- footer section -->



  <script src="/js/jquery-3.4.1.min.js"></script>
  <!-- popper js -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
  </script>
  <!-- bootstrap js -->
  <script src="/js/bootstrap.js"></script>
  <!-- owl slider -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js">
  </script>
  <!-- isotope js -->
  <script src="https://unpkg.com/isotope-layout@3.0.4/dist/isotope.pkgd.min.js"></script>
  <!-- nice select -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js"></script>
  <!-- custom js -->
  <script src="/js/custom.js"></script>
  <!-- Google Map -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap">
  </script>
  <!-- End Google Map -->   
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const quantityControls = document.querySelectorAll('.quantity-control');

  quantityControls.forEach(control => {
    const minusBtn = control.querySelector('.minus');
    const plusBtn = control.querySelector('.plus');
    const input = control.querySelector('.quantity-input');
    const cartItem = control.closest('.cart-item');
    const itemId = cartItem.dataset.itemId;
    const priceElement = cartItem.querySelector('.price-value');
    const originalPrice = parseFloat(priceElement.textContent) / parseInt(input.value);

    minusBtn.addEventListener('click', () => updateQuantity(-1));
    plusBtn.addEventListener('click', () => updateQuantity(1));

    function updateQuantity(change) {
      let newQuantity = parseInt(input.value) + change;
      const maxQuantity = 5;
      const minQuantity = 1;

      if (newQuantity > maxQuantity) {
        Swal.fire({
          icon: 'warning',
          title: 'Maximum Quantity Reached',
          text: 'You can only order up to 5 units of this item.',
        });
        return;
      }

      newQuantity = Math.max(minQuantity, Math.min(newQuantity, maxQuantity));

      updateCartOnServer(itemId, newQuantity)
        .then(response => {
          if (response.success) {
            input.value = newQuantity;
            const newPrice = originalPrice * newQuantity;
            priceElement.textContent = newPrice.toFixed(2);
            updateTotalPrice();
          } else {
            Swal.fire({
              icon: 'error',
              title: 'Oops...',
              text: response.message || 'Failed to update quantity',
            });
          }
        })
        .catch(error => {
          console.error('Error updating cart:', error);
          Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'An error occurred while updating the cart',
          });
        });
    }
  });

  function updateCartOnServer(itemId, quantity) {
    return fetch('/update-cart-quantity', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ itemId, quantity }),
    })
    .then(response => response.json());
  }

  function updateTotalPrice() {
    const priceElements = document.querySelectorAll('.price-value');
    const total = Array.from(priceElements).reduce((sum, el) => sum + parseFloat(el.textContent), 0);
    document.getElementById('cart-total').textContent = total.toFixed(2);
  }
});


// Keep the existing remove item script
document.querySelectorAll('.remove-item-btn').forEach(button => {
  button.addEventListener('click', function() {
    const itemId = this.getAttribute('data-item-id');
    Swal.fire({
      title: 'Are you sure?',
      text: "Do you want to remove this item from your cart?",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes, remove it!'
    }).then((result) => {
      if (result.isConfirmed) {
        fetch('/remove-cart-item', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ itemId: itemId }),
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            Swal.fire(
              'Removed!',
              'Item has been removed from your cart.',
              'success'
            ).then(() => {
              // Refresh the page after removing the item
              window.location.reload();
            });
          } else {
            Swal.fire(
              'Error!',
              data.message,
              'error'
            );
          }
        })
        .catch(error => {
          console.error('Error:', error);
          Swal.fire(
            'Oops!',
            'An error occurred while removing the item.',
            'error'
          );
        });
      }
    });
  });
});


</script>

</body>
</html>

<!----------------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------------->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order History</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <style>
        body {
            background-color: #f8f9fa;
        }

        .container {
            margin-top: 50px;
            margin-bottom: 50px;
        }

        h1 {
            margin-bottom: 30px;
            font-weight: 600;
        }

        .table {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .table th,
        .table td {
            vertical-align: middle;
        }

        .table thead th {
            background-color: #007bff;
            color: white;
        }

        .table tbody tr:hover {
            background-color: #e9ecef;
            cursor: pointer;
        }

        .collapse {
            margin-top: 10px;
        }

        .order-image {
            max-width: 100px; /* Limit image width */
            height: auto; /* Maintain aspect ratio */
        }
        /* Breadcrumb styling */
        .breadcrumb-item a {
            text-decoration: none;
        }

        /* Pagination styling */
        .pagination {
            justify-content: center;
            margin-top: 20px;
        }

        .pagination a {
            text-decoration: none;
        }

        .pagination .page-item.active .page-link {
            background-color: #007bff;
            border-color: #007bff;
            color: white;
        }
        .breadcrumb {
            background-color: #f8f9fa; /* Light background for breadcrumb */
            border-radius: 0.375rem; /* Rounded corners */
            padding: 0.75rem 1rem;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); /* Subtle shadow */
        }

        .breadcrumb-item + .breadcrumb-item::before {
            content: ">";
            color: #6c757d; /* Gray color for separator */
        }

        .breadcrumb-item a {
            text-decoration: none;
            color: #007bff; /* Bootstrap primary color */
        }

        .breadcrumb-item a:hover {
            text-decoration: underline;
        }

        .breadcrumb-item.active {
            color: #6c757d; /* Gray color for active item */
        }
        .navbar a{
            color: #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/userHomePage">Home</a></li>
            <li class="breadcrumb-item"><a href="/checkOutPage">Cart Page</a></li>
            <li class="breadcrumb-item active" aria-current="page">Order History</li>
        </ol>
    </nav>    
    <h1 class="text-center">Order History</h1>
    <div class="table-responsive">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th scope="col">Order Id</th>
                    <th scope="col">Product Name</th>
                    <th scope="col">Status</th>
                    <th scope="col">Payment Method</th>
                    <th scope="col">Total</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody>
                <% if (orders.length > 0) { %>
                    <% orders.forEach((order, index) => { %>
                    <tr>
                        <th scope="row"><%= order.orderId %></th>
                        <td>
                            <% order.items.forEach((item, itemIndex) => { %>
                                <%= item.product.productname %><br>
                            <% }); %>
                        </td>
                        <td><%= order.orderStatus %></td>
                        <td><%= order.paymentMethod %></td>
                        <td><%= order.totalAmount %></td>
                        <td class="d-flex justify-content-between">
                            <% if (['Processing', 'Shipped', 'Delivered', 'Cancelled'].includes(order.orderStatus)) { %>
                                <button type="button" class="btn btn-secondary" disabled>
                                    <%= order.orderStatus === 'Cancelled' ? 'Cancelled' : 'Cancel' %>
                                </button>
                            <% } else { %>
                                <button type="button" class="btn btn-danger" onclick="cancelOrder('<%= order.orderId %>', this)">Cancel</button>
                            <% } %>
                            <button class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="#details<%= index %>" aria-expanded="false" aria-controls="details<%= index %>">Details</button>
                        </td>
                    </tr>
                    <tr class="collapse" id="details<%= index %>">
                        <td colspan="6">
                            <div class="p-3">
                                <ul>
                                    <% order.items.forEach((item) => { %>
                                        <li>
                                            <img src="<%= item.product.images[0] %>" alt="" class="order-image">
                                        </li>
                                    <% }); %>
                                </ul>
                                
                                <ul>
                                    <ul>
                                        <% order.items.forEach((item) => { %>
                                            <li>Product: <%= item.product.productname %> - Quantity: <%= item.quantity %></li>
                                        <% }); %>
                                    </ul>
                                    
                                    <li>Order Date: <%= order.createdAt.toLocaleString() %></li>
                                    <li>Estimate Delivery Time: 
                                        <%= new Date(order.createdAt.getTime() + 30 * 60 * 1000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) %>
                                    </li>                             
                                    <li>Shipping Address: <%= order.address ? order.address.streetAddress : "No address provided" %></li>

                                </ul>
                            </div>
                        </td>
                    </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="6" class="text-center">No orders found.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </div>    
        </div>
    </div>
    <footer id="colorlib-footer" role="contentinfo">
        <div class="container">
            <div class="row row-pb-md">
                <div class="col footer-col colorlib-widget">
                    <h4>About Footwear</h4>
                    <p>Even the all-powerful Pointing has no control about the blind texts it is an almost
                        unorthographic life</p>
                    <p>
                    <ul class="colorlib-social-icons">
                        <li><a href="#"><i class="icon-twitter"></i></a></li>
                        <li><a href="#"><i class="icon-facebook"></i></a></li>
                        <li><a href="#"><i class="icon-linkedin"></i></a></li>
                        <li><a href="#"><i class="icon-dribbble"></i></a></li>
                    </ul>
                    </p>
                </div>
                <div class="col footer-col colorlib-widget">
                    <h4>Customer Care</h4>
                    <p>
                    <ul class="colorlib-footer-links">
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Returns/Exchange</a></li>
                        <li><a href="#">Gift Voucher</a></li>
                        <li><a href="#">Wishlist</a></li>
                        <li><a href="#">Special</a></li>
                        <li><a href="#">Customer Services</a></li>
                        <li><a href="#">Site maps</a></li>
                    </ul>
                    </p>
                </div>
                <div class="col footer-col colorlib-widget">
                    <h4>Information</h4>
                    <p>
                    <ul class="colorlib-footer-links">
                        <li><a href="#">About us</a></li>
                        <li><a href="#">Delivery Information</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Support</a></li>
                        <li><a href="#">Order Tracking</a></li>
                    </ul>
                    </p>
                </div>

                <div class="col footer-col">
                    <h4>News</h4>
                    <ul class="colorlib-footer-links">
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="#">Press</a></li>
                        <li><a href="#">Exhibitions</a></li>
                    </ul>
                </div>

                <div class="col footer-col">
                    <h4>Contact Information</h4>
                    <ul class="colorlib-footer-links">
                        <li>291 South 21th Street, <br> Suite 721 New York NY 10016</li>
                        <li><a href="tel://1234567920">+ 1235 2355 98</a></li>
                        <li><a href="mailto:info@yoursite.com">info@yoursite.com</a></li>
                        <li><a href="#">yoursite.com</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="copy">
            <div class="row">
                <div class="col-sm-12 text-center">
                    <p>
                        <span><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                            template is made with <i class="icon-heart" aria-hidden="true"></i> by <a
                                href="https://colorlib.com" target="_blank">Colorlib</a>
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        </span>
                        <span class="block">Demo Images: <a href="http://unsplash.co/" target="_blank">Unsplash</a>
                            , <a href="http://pexels.com/" target="_blank">Pexels.com</a></span>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
    <script>
        async function cancelOrder(orderId, button) {
            // Check if the button is disabled
            if (button.disabled) {
                Swal.fire({
                    title: 'Cannot Cancel',
                    text: 'This order cannot be cancelled at this time.',
                    icon: 'info',
                });
                return;
            }

            try {
                // Disable the button and change its text immediately
                button.disabled = true;
                button.textContent = 'Cancelling...';

                const response = await fetch(`/orders/${orderId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ orderId }),
                });

                if (response.ok) {
                    const result = await response.json();
                    button.textContent = 'Cancelled';
                    button.classList.remove('btn-danger');
                    button.classList.add('btn-secondary');
                    Swal.fire({
                        title: 'Success!',
                        text: result.message,
                        icon: 'success',
                        timer: 1000,
                        showConfirmButton: false,
                    }).then(() => {
                        const redirectUrl = result.redirect || "/orderHistory";
                        window.location.href = redirectUrl;
                    });
                } else {
                    const result = await response.json();
                    // Re-enable the button if there's an error
                    button.disabled = false;
                    button.textContent = 'Cancel';
                    Swal.fire({
                        title: 'Error!',
                        text: result.message,
                        icon: 'error',
                    });
                }
            } catch (error) {
                // Re-enable the button if there's an error
                button.disabled = false;
                button.textContent = 'Cancel';
                Swal.fire({
                    title: 'Error!',
                    text: 'Something went wrong.',
                    icon: 'error',
                });
            }
        }
    </script>

</body>
</html>
